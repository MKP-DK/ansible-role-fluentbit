[SERVICE]
{% if fluentbit_service_flush_seconds is defined %}
    Flush        {{ fluentbit_service_flush_seconds }}
{% endif %}
{% if fluentbit_service_daemon is defined %}
    Daemon       {{ (fluentbit_service_daemon | bool) | ternary('On', 'Off' ) }}
{% endif %}
{% if fluentbit_service_log_level is defined %}
    Log_Level    {{ fluentbit_service_log_level }}
{% endif %}    
{% if fluentbit_service_storage_path is defined %}
    storage.path {{ fluentbit_service_storage_path }}
{% endif %}
    Parsers_File parsers.conf
    Plugins_File plugins.conf
{% if fluentbit_service_enable_metrics is defined %}
    HTTP_Server  {{ (fluentbit_service_enable_metrics | bool) | ternary('On', 'Off' ) }}
{% endif %}
{% if fluentbit_service_metrics_listen_ip is defined %}
    HTTP_Listen  {{ fluentbit_service_metrics_listen_ip }}
{% endif %}
{% if fluentbit_service_metrics_listen_port is defined %}
    HTTP_Port    {{ fluentbit_service_metrics_listen_port }}
{% endif %}
[INPUT]
#ONLY STATIC CONFIG IN THIS SECTION

{% if fluentbit_outputs is defined %}
[OUTPUT]
    name:           forward
    match:          '*'
    host:           10.7.0.5
    port:           24224
    shared_key:     ${SHAREDKEY}
    self_hostname:  ${HOSTNAME}
    tls:            on
    tls.verify:     off
    name:           prometheus_exporter
    match:          node_metrics
    host:           0.0.0.0
    port:           2021
{% for key in input %}
    {{ key }} {{ input[key] }}
{% endfor %}
{% endif %}

[FILTER]
#ONLY STATIC CONFIG IN THIS SECTION
@INCLUDE /etc/fluent-bit/dynamic/*.conf